<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.19" /><meta name="theme" content="VuePress Theme Plume " /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><title>系统安全机制 | My Vuepress Site</title><meta name="description" content=""><link rel="preload" href="/henry.github.io/assets/style-iCC0LYON.css" as="style"><link rel="stylesheet" href="/henry.github.io/assets/style-iCC0LYON.css"><link rel="modulepreload" href="/henry.github.io/assets/app-BNwF3TyR.js"><link rel="modulepreload" href="/henry.github.io/assets/index.html-YKCyCb16.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-6b855051><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-6665853b></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-6665853b> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-6b855051 data-v-b27f9974><div class="vp-navbar" vp-navbar data-v-b27f9974 data-v-bd857425><div class="wrapper" data-v-bd857425><div class="container" data-v-bd857425><div class="title" data-v-bd857425><div class="vp-navbar-title has-sidebar" data-v-bd857425 data-v-2ef7f17a><a class="vp-link no-icon link title" href="/henry.github.io/" data-v-2ef7f17a data-v-87b5717a><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" src="https://theme-plume.vuejs.press/plume.png" alt data-v-e3c54c70><!--]--><!--[--><img class="vp-image light logo" src="https://theme-plume.vuejs.press/plume.png" alt data-v-e3c54c70><!--]--><!--]--><!--]--><span data-v-2ef7f17a>My Vuepress Site</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-bd857425><div class="content-body" data-v-bd857425><!--[--><!--]--><div class="vp-navbar-search search" data-v-bd857425><div class="search-wrapper" data-v-42ff2bf3><!----><div id="local-search" data-v-42ff2bf3><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-42ff2bf3><span class="mini-search-button-container"><svg class="mini-search-search-icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-bd857425 data-v-6d8fb5f6><span id="main-nav-aria-label" class="visually-hidden" data-v-6d8fb5f6>Main Navigation</span><!--[--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/henry.github.io/" tabindex="0" data-v-6d8fb5f6 data-v-ac70cb14 data-v-87b5717a><!--[--><!----><span data-v-ac70cb14>首页</span><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/henry.github.io/blog/" tabindex="0" data-v-6d8fb5f6 data-v-ac70cb14 data-v-87b5717a><!--[--><!----><span data-v-ac70cb14>博客</span><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/henry.github.io/blog/tags/" tabindex="0" data-v-6d8fb5f6 data-v-ac70cb14 data-v-87b5717a><!--[--><!----><span data-v-ac70cb14>标签</span><!--]--><!----></a><!--]--><!--[--><a class="vp-link no-icon link navbar-menu-link" href="/henry.github.io/blog/archives/" tabindex="0" data-v-6d8fb5f6 data-v-ac70cb14 data-v-87b5717a><!--[--><!----><span data-v-ac70cb14>归档</span><!--]--><!----></a><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-6d8fb5f6 data-v-f5157cbd><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-f5157cbd><span class="text" data-v-f5157cbd><!----><!----><span data-v-f5157cbd>笔记</span><span class="vpi-chevron-down text-icon" data-v-f5157cbd></span></span></button><div class="menu" data-v-f5157cbd><div class="vp-menu" data-v-f5157cbd data-v-22b26cbd><div class="items" data-v-22b26cbd><!--[--><!--[--><div class="vp-menu-link" data-v-22b26cbd data-v-d5eb0fee><a class="vp-link no-icon link" href="/henry.github.io/android/" data-v-d5eb0fee data-v-87b5717a><!--[--><!----> Android<!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-22b26cbd data-v-d5eb0fee><a class="vp-link no-icon link" href="/henry.github.io/ddia/" data-v-d5eb0fee data-v-87b5717a><!--[--><!----> DDIA 学习笔记<!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-22b26cbd data-v-d5eb0fee><a class="vp-link no-icon link" href="/henry.github.io/demo/" data-v-d5eb0fee data-v-87b5717a><!--[--><!----> Demo<!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-22b26cbd data-v-d5eb0fee><a class="vp-link no-icon link" href="/henry.github.io/flutter/" data-v-d5eb0fee data-v-87b5717a><!--[--><!----> Flutter<!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-22b26cbd data-v-d5eb0fee><a class="vp-link no-icon link" href="/henry.github.io/ui/" data-v-d5eb0fee data-v-87b5717a><!--[--><!----> Ui<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><div class="vp-flyout vp-navbar-translations translations" data-v-bd857425 data-v-0ffcc6de data-v-f5157cbd><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="选择语言" data-v-f5157cbd><span class="text" data-v-f5157cbd><!----><span class="vpi-languages option-icon" data-v-f5157cbd></span><!----><span class="vpi-chevron-down text-icon" data-v-f5157cbd></span></span></button><div class="menu" data-v-f5157cbd><div class="vp-menu" data-v-f5157cbd data-v-22b26cbd><!----><!--[--><!--[--><div class="items" data-v-0ffcc6de><p class="title" data-v-0ffcc6de>简体中文</p><!--[--><div class="vp-menu-link" data-v-0ffcc6de data-v-d5eb0fee><a class="vp-link no-icon link" href="/henry.github.io/en/" data-v-d5eb0fee data-v-87b5717a><!--[--><!----> English<!--]--><!----></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="vp-navbar-appearance appearance" data-v-bd857425 data-v-d9c55eda><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-d9c55eda data-v-ad1b2bdf data-v-61405998><span class="check" data-v-61405998><span class="icon" data-v-61405998><!--[--><span class="vpi-sun sun" data-v-ad1b2bdf></span><span class="vpi-moon moon" data-v-ad1b2bdf></span><!--]--></span></span></button></div><div class="vp-social-links vp-navbar-social-links social-links" data-v-bd857425 data-v-26cdeb54 data-v-03411773><!--[--><a class="vp-social-link no-icon" href="/" aria-label="github" target="_blank" rel="noopener" data-v-03411773 data-v-4463c1f8><span class="vpi-social-github" /></a><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-bd857425 data-v-ff262915 data-v-f5157cbd><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-f5157cbd><span class="vpi-more-horizontal icon" data-v-f5157cbd></span></button><div class="menu" data-v-f5157cbd><div class="vp-menu" data-v-f5157cbd data-v-22b26cbd><!----><!--[--><!--[--><div class="group translations" data-v-ff262915><p class="trans-title" data-v-ff262915>简体中文</p><!--[--><div class="vp-menu-link" data-v-ff262915 data-v-d5eb0fee><a class="vp-link no-icon link" href="/henry.github.io/en/" data-v-d5eb0fee data-v-87b5717a><!--[--><!----> English<!--]--><!----></a></div><!--]--></div><div class="group" data-v-ff262915><div class="item appearance" data-v-ff262915><p class="label" data-v-ff262915>外观</p><div class="appearance-action" data-v-ff262915><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-ff262915 data-v-ad1b2bdf data-v-61405998><span class="check" data-v-61405998><span class="icon" data-v-61405998><!--[--><span class="vpi-sun sun" data-v-ad1b2bdf></span><span class="vpi-moon moon" data-v-ad1b2bdf></span><!--]--></span></span></button></div></div></div><div class="group" data-v-ff262915><div class="item social-links" data-v-ff262915><div class="vp-social-links social-links-list" data-v-ff262915 data-v-03411773><!--[--><a class="vp-social-link no-icon" href="/" aria-label="github" target="_blank" rel="noopener" data-v-03411773 data-v-4463c1f8><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-bd857425 data-v-bc2fdff4><span class="container" data-v-bc2fdff4><span class="top" data-v-bc2fdff4></span><span class="middle" data-v-bc2fdff4></span><span class="bottom" data-v-bc2fdff4></span></span></button></div></div></div></div><div class="divider" data-v-bd857425><div class="divider-line" data-v-bd857425></div></div></div><!----></header><div class="vp-local-nav reached-top is-blog" data-v-6b855051 data-v-a9fbedc4><button class="menu" aria-expanded="false" aria-controls="SidebarNav" data-v-a9fbedc4><span class="vpi-align-left menu-icon" data-v-a9fbedc4></span><span class="menu-text" data-v-a9fbedc4>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-a9fbedc4 data-v-efb9a031><button data-v-efb9a031>返回顶部</button><!----></div></div><aside class="vp-sidebar" vp-sidebar data-v-6b855051 data-v-e8b1f427><div class="curtain" data-v-e8b1f427></div><nav id="SidebarNav" class="nav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-e8b1f427><span id="sidebar-aria-label" class="visually-hidden" data-v-e8b1f427> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c7d7fce2><section class="vp-sidebar-item sidebar-item level-0" data-v-c7d7fce2 data-v-13ba94ca><!----><div class="items" data-v-13ba94ca><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/ai/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>ai</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c7d7fce2><section class="vp-sidebar-item sidebar-item level-0 collapsible is-link has-active" data-v-c7d7fce2 data-v-13ba94ca><div class="item" tabindex="0" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/framework/" data-v-13ba94ca data-v-87b5717a><!--[--><h2 class="text" data-v-13ba94ca>framework</h2><!--]--><!----></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-13ba94ca><span class="vpi-chevron-right caret-icon" data-v-13ba94ca></span></div></div><div class="items" data-v-13ba94ca><!--[--><section class="vp-sidebar-item sidebar-item level-1 collapsible is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" tabindex="0" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/sbfm5iz4/" data-v-13ba94ca data-v-87b5717a><!--[--><h3 class="text" data-v-13ba94ca>01</h3><!--]--><!----></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-13ba94ca><span class="vpi-chevron-right caret-icon" data-v-13ba94ca></span></div></div><div class="items" data-v-13ba94ca><!--[--><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/ugfhkbji/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>Framework基础入门</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="vp-sidebar-item sidebar-item level-1 collapsible is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" tabindex="0" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/6bsq9v0u/" data-v-13ba94ca data-v-87b5717a><!--[--><h3 class="text" data-v-13ba94ca>02</h3><!--]--><!----></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-13ba94ca><span class="vpi-chevron-right caret-icon" data-v-13ba94ca></span></div></div><div class="items" data-v-13ba94ca><!--[--><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/ry4zwt1h/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>Binder机制详解</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/iojajn5p/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>Handler消息机制</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/zts8xro7/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>系统服务概览</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="vp-sidebar-item sidebar-item level-1 collapsible is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" tabindex="0" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/x5ulw5ue/" data-v-13ba94ca data-v-87b5717a><!--[--><h3 class="text" data-v-13ba94ca>03</h3><!--]--><!----></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-13ba94ca><span class="vpi-chevron-right caret-icon" data-v-13ba94ca></span></div></div><div class="items" data-v-13ba94ca><!--[--><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/sr6zxlql/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>UI渲染机制</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/wmrxwjaw/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>应用启动流程</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/vuo6i9ic/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>系统启动流程</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/b5djrrcj/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>输入事件处理</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="vp-sidebar-item sidebar-item level-1 collapsible is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" tabindex="0" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/x8ps2hzu/" data-v-13ba94ca data-v-87b5717a><!--[--><h3 class="text" data-v-13ba94ca>04</h3><!--]--><!----></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-13ba94ca><span class="vpi-chevron-right caret-icon" data-v-13ba94ca></span></div></div><div class="items" data-v-13ba94ca><!--[--><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/qux9vabx/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>HAL层开发与HIDL</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/vl93d5tm/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>开发环境搭建与调试</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/povslsa0/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>性能优化实践</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/6aw843ik/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>系统服务开发实践</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="vp-sidebar-item sidebar-item level-1 collapsible is-link has-active" data-v-13ba94ca data-v-13ba94ca><div class="item" tabindex="0" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/9qu6bk2s/" data-v-13ba94ca data-v-87b5717a><!--[--><h3 class="text" data-v-13ba94ca>05</h3><!--]--><!----></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-13ba94ca><span class="vpi-chevron-right caret-icon" data-v-13ba94ca></span></div></div><div class="items" data-v-13ba94ca><!--[--><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/vo6noktt/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>定制ROM开发</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/k2w93lx1/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>系统安全机制</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/lc7oiob0/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>系统更新与OTA</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="vp-sidebar-item sidebar-item level-1 collapsible is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" tabindex="0" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/rjp8dtw1/" data-v-13ba94ca data-v-87b5717a><!--[--><h3 class="text" data-v-13ba94ca>06</h3><!--]--><!----></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-13ba94ca><span class="vpi-chevron-right caret-icon" data-v-13ba94ca></span></div></div><div class="items" data-v-13ba94ca><!--[--><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/60z0f2y1/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>SystemUI定制项目实践</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/yqmpplty/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>完整ROM定制项目实践</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/9w5avu3w/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>系统优化项目实践</p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-2 is-link" data-v-13ba94ca data-v-13ba94ca><div class="item" data-v-13ba94ca><div class="indicator" data-v-13ba94ca></div><!----><a class="vp-link no-icon link link" href="/henry.github.io/android/t2td3guh/" data-v-13ba94ca data-v-87b5717a><!--[--><p class="text" data-v-13ba94ca>自定义系统服务项目实践</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><!--[--><div id="VPContent" vp-content class="vp-content has-sidebar" data-v-6b855051 data-v-6d75db73><div class="has-sidebar has-aside vp-doc-container" data-v-94616537><!--[--><!--]--><div class="container" data-v-94616537><div class="aside" vp-outline data-v-94616537><div class="aside-curtain" data-v-94616537></div><div class="aside-container" data-v-94616537><div class="aside-content" data-v-94616537><div class="vp-doc-aside" data-v-94616537 data-v-c5a5865a><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-c5a5865a data-v-2d954bbe><div class="content" data-v-2d954bbe><div class="outline-marker" data-v-2d954bbe></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-2d954bbe><span data-v-2d954bbe>此页内容</span><span class="vpi-print icon" data-v-2d954bbe></span></div><ul class="root" data-v-2d954bbe data-v-a404a7d7><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-c5a5865a></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-94616537><div class="content-container" data-v-94616537><!--[--><!--]--><main class="main" data-v-94616537><nav class="vp-breadcrumb" data-v-94616537 data-v-5efe8592><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-5efe8592><!--[--><li property="itemListElement" typeof="ListItem" data-v-5efe8592><a class="vp-link no-icon link breadcrumb" href="/henry.github.io/" property="item" typeof="WebPage" data-v-5efe8592 data-v-87b5717a><!--[-->首页<!--]--><!----></a><span class="vpi-chevron-right" data-v-5efe8592></span><meta property="name" content="首页" data-v-5efe8592><meta property="position" content="1" data-v-5efe8592></li><li property="itemListElement" typeof="ListItem" data-v-5efe8592><a class="vp-link no-icon link breadcrumb" href="/henry.github.io/android/framework/" property="item" typeof="WebPage" data-v-5efe8592 data-v-87b5717a><!--[-->framework<!--]--><!----></a><span class="vpi-chevron-right" data-v-5efe8592></span><meta property="name" content="framework" data-v-5efe8592><meta property="position" content="2" data-v-5efe8592></li><li property="itemListElement" typeof="ListItem" data-v-5efe8592><a class="vp-link no-icon link breadcrumb" href="/henry.github.io/android/9qu6bk2s/" property="item" typeof="WebPage" data-v-5efe8592 data-v-87b5717a><!--[-->05<!--]--><!----></a><span class="vpi-chevron-right" data-v-5efe8592></span><meta property="name" content="05" data-v-5efe8592><meta property="position" content="3" data-v-5efe8592></li><li property="itemListElement" typeof="ListItem" data-v-5efe8592><a class="vp-link no-icon link breadcrumb current" href="/henry.github.io/android/k2w93lx1/" property="item" typeof="WebPage" data-v-5efe8592 data-v-87b5717a><!--[-->系统安全机制<!--]--><!----></a><!----><meta property="name" content="系统安全机制" data-v-5efe8592><meta property="position" content="4" data-v-5efe8592></li><!--]--></ol></nav><!--[--><h1 class="vp-doc-title page-title" data-v-349c6f6c>系统安全机制 <!----></h1><div class="vp-doc-meta" data-v-349c6f6c><p class="reading-time" data-v-349c6f6c><span class="vpi-books icon" data-v-349c6f6c></span><span data-v-349c6f6c>约 1829 字</span><span data-v-349c6f6c>大约 6 分钟</span></p><!----><p class="create-time" data-v-349c6f6c><span class="vpi-clock icon" data-v-349c6f6c></span><span data-v-349c6f6c>2025-04-29</span></p></div><!--]--><div class="_android_k2w93lx1_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-94616537><div data-v-94616537><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介"><span>简介</span></a></h2><p>Android系统的安全架构基于多层防御策略，包括应用沙盒、权限系统、加密存储和安全通信等。本文将深入探讨Android Framework层中的安全机制实现，包括权限管理、应用签名验证、SELinux策略等核心安全特性。</p><h2 id="安全架构概述" tabindex="-1"><a class="header-anchor" href="#安全架构概述"><span>安全架构概述</span></a></h2><p>Android的安全架构构建在以下几个关键层面：</p><ol><li><strong>Linux内核安全</strong>：进程隔离、文件访问控制、内存保护</li><li><strong>应用沙盒</strong>：每个应用运行在独立的沙盒环境中</li><li><strong>权限系统</strong>：细粒度的功能访问控制</li><li><strong>应用签名</strong>：确保应用完整性和来源可信</li><li><strong>安全启动</strong>：验证系统完整性的启动链</li><li><strong>SELinux强制访问控制</strong>：限制进程的系统资源访问</li></ol><h2 id="权限系统实现" tabindex="-1"><a class="header-anchor" href="#权限系统实现"><span>权限系统实现</span></a></h2><h3 id="权限定义与分类" tabindex="-1"><a class="header-anchor" href="#权限定义与分类"><span>权限定义与分类</span></a></h3><p>Android权限系统在Framework层中的主要实现位于<code>PermissionManagerService</code>：</p><ul><li><strong>普通权限</strong>：安装时自动授予</li><li><strong>危险权限</strong>：需要用户明确授权</li><li><strong>特殊权限</strong>：需要通过特定方式授予</li><li><strong>系统权限</strong>：仅供系统应用使用</li></ul><p>权限定义示例(AndroidManifest.xml)：</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">permission</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    android</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">android.permission.CAMERA</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    android</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">description</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">@string/permlab_camera</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    android</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">label</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">@string/permlab_camera</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    android</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">protectionLevel</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">dangerous</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> /&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="权限检查流程" tabindex="-1"><a class="header-anchor" href="#权限检查流程"><span>权限检查流程</span></a></h3><ol><li>应用请求访问受保护功能</li><li>Framework层调用<code>checkPermission()</code>方法</li><li><code>PermissionManagerService</code>验证应用是否持有所需权限</li><li>如未授权，抛出<code>SecurityException</code></li></ol><p>核心实现示例：</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 权限检查的简化实现</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> int</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> checkPermission</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">String permission</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> int</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> pid</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> int</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> uid</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">permission </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">==</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> null</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> PackageManager</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">PERMISSION_DENIED</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 检查是否是系统进程</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">uid </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">==</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">ROOT_UID</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ||</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> uid </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">==</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> Process</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">SYSTEM_UID</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> PackageManager</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">PERMISSION_GRANTED</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 查询权限状态</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> mPackageManagerInternal</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">checkUidPermission</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">permission</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> uid</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="运行时权限管理" tabindex="-1"><a class="header-anchor" href="#运行时权限管理"><span>运行时权限管理</span></a></h3><p>Android 6.0引入的运行时权限由<code>PermissionController</code>管理，主要组件包括：</p><ul><li><strong>PermissionManagerService</strong>：核心权限管理服务</li><li><strong>PermissionDialogReqQueue</strong>：权限请求队列</li><li><strong>PackageManager</strong>：应用包管理</li><li><strong>PermissionPolicyService</strong>：权限策略实施</li></ul><h2 id="应用签名与验证" tabindex="-1"><a class="header-anchor" href="#应用签名与验证"><span>应用签名与验证</span></a></h2><h3 id="签名机制" tabindex="-1"><a class="header-anchor" href="#签名机制"><span>签名机制</span></a></h3><p>Android要求所有应用必须签名，签名验证在<code>PackageManagerService</code>中实现：</p><ol><li>安装应用时验证APK签名</li><li>验证更新时的签名一致性</li><li>基于签名实现特权授予</li></ol><h3 id="签名验证流程" tabindex="-1"><a class="header-anchor" href="#签名验证流程"><span>签名验证流程</span></a></h3><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 签名验证简化实现</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">private</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> void</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> verifySignatures</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">PackageParser</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">Package</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> pkg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> throws PackageManagerException </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pkg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">mSignatures</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> ==</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> null</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        throw</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> new</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> PackageManagerException</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                INSTALL_PARSE_FAILED_NO_CERTIFICATES</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">                &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Package has no certificates</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 对已安装应用的更新，验证签名一致性</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">mPackages</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">containsKey</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pkg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">packageName</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        PackageParser</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">Package</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> existingPkg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> mPackages</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">get</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">pkg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">packageName</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        if</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">!</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">compareSignatures</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">existingPkg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">mSignatures</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> pkg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">mSignatures</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">))</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            throw</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> new</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> PackageManagerException</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">                    INSTALL_PARSE_FAILED_INCONSISTENT_CERTIFICATES</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">                    &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Update signature mismatch</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="selinux实现" tabindex="-1"><a class="header-anchor" href="#selinux实现"><span>SELinux实现</span></a></h2><h3 id="selinux在android中的应用" tabindex="-1"><a class="header-anchor" href="#selinux在android中的应用"><span>SELinux在Android中的应用</span></a></h3><p>Android使用SELinux（Security-Enhanced Linux）实现强制访问控制：</p><ol><li><strong>域隔离</strong>：应用和系统服务运行在不同SELinux域中</li><li><strong>策略定义</strong>：定义了各域可访问的资源</li><li><strong>强制执行</strong>：无视传统的Linux DAC权限，强制执行访问规则</li></ol><h3 id="selinux策略示例" tabindex="-1"><a class="header-anchor" href="#selinux策略示例"><span>SELinux策略示例</span></a></h3><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span># app.te - 普通应用域策略示例</span></span>
<span class="line"><span>type untrusted_app, domain;</span></span>
<span class="line"><span># 允许应用访问自己的数据目录</span></span>
<span class="line"><span>allow untrusted_app app_data_file:dir create_dir_perms;</span></span>
<span class="line"><span>allow untrusted_app app_data_file:file create_file_perms;</span></span>
<span class="line"><span># 禁止应用访问系统数据</span></span>
<span class="line"><span>neverallow untrusted_app system_data_file:dir *;</span></span>
<span class="line"><span>neverallow untrusted_app system_data_file:file *;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="selinux集成" tabindex="-1"><a class="header-anchor" href="#selinux集成"><span>SELinux集成</span></a></h3><p>Framework通过<code>SELinuxPolicyInstaller</code>和<code>SELinuxMMAC</code>在启动时加载SELinux策略。<code>android.os.SELinux</code>类提供了Java API用于SELinux操作：</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 检查SELinux是否启用</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">boolean</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> isEnabled</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> SELinux</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">isSELinuxEnabled</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 获取当前上下文</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">String</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> context</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> SELinux</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">getContext</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// 检查访问权限</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">boolean</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> hasAccess</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> SELinux</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">checkSELinuxAccess</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">u:r:system_app:s0</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">                                            &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">u:r:untrusted_app:s0</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">                                            &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">file</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">read</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安全存储" tabindex="-1"><a class="header-anchor" href="#安全存储"><span>安全存储</span></a></h2><h3 id="keystore系统" tabindex="-1"><a class="header-anchor" href="#keystore系统"><span>Keystore系统</span></a></h3><p>Android的<code>KeyStore</code>系统提供安全密钥存储：</p><ol><li><strong>硬件支持</strong>：在支持TEE或StrongBox的设备上，密钥材料保存在硬件中</li><li><strong>密钥隔离</strong>：每个应用只能访问自己创建的密钥</li><li><strong>用途限制</strong>：可以限制密钥的使用场景（仅签名、仅加密等）</li></ol><p>Framework实现由<code>KeyStoreService</code>和<code>Keymaster HAL</code>共同完成。</p><h3 id="文件加密" tabindex="-1"><a class="header-anchor" href="#文件加密"><span>文件加密</span></a></h3><p>Android提供两级文件加密：</p><ol><li><strong>全盘加密(FDE)</strong>：整个用户数据分区加密</li><li><strong>基于文件的加密(FBE)</strong>：单独加密每个文件，支持多用户隔离</li></ol><p>Framework中，由<code>StorageManagerService</code>和<code>VoldNativeService</code>实现加密相关功能。</p><h2 id="生物认证框架" tabindex="-1"><a class="header-anchor" href="#生物认证框架"><span>生物认证框架</span></a></h2><p>Android生物认证框架(<code>BiometricManager</code>)允许应用使用指纹、面部识别等进行身份验证：</p><ol><li><strong>统一API</strong>：应用使用统一接口而不关心具体实现</li><li><strong>安全存储</strong>：生物特征数据安全存储在TEE中</li><li><strong>HAL隔离</strong>：生物识别硬件通过HAL接口访问</li></ol><h2 id="系统完整性保护" tabindex="-1"><a class="header-anchor" href="#系统完整性保护"><span>系统完整性保护</span></a></h2><h3 id="验证启动" tabindex="-1"><a class="header-anchor" href="#验证启动"><span>验证启动</span></a></h3><p>Android实现了验证启动链：</p><ol><li><strong>硬件信任根</strong>：从硬件信任根开始验证</li><li><strong>引导加载程序</strong>：验证boot.img</li><li><strong>系统分区</strong>：验证system.img</li><li><strong>Verified Boot</strong>：确保设备以已知良好状态启动</li></ol><h3 id="dm-verity" tabindex="-1"><a class="header-anchor" href="#dm-verity"><span>dm-verity</span></a></h3><p>dm-verity提供运行时系统分区完整性保护：</p><ol><li>系统分区被构建为包含哈希树的只读映像</li><li>每次读取时验证块的完整性</li><li>如果检测到篡改，设备可能拒绝启动或进入只读模式</li></ol><h2 id="漏洞防护机制" tabindex="-1"><a class="header-anchor" href="#漏洞防护机制"><span>漏洞防护机制</span></a></h2><h3 id="aslr-地址空间布局随机化" tabindex="-1"><a class="header-anchor" href="#aslr-地址空间布局随机化"><span>ASLR(地址空间布局随机化)</span></a></h3><p>Android实现了完整的ASLR，随机化进程的内存布局：</p><ul><li>栈、堆、共享库、可执行文件的基址都被随机化</li><li>减少内存攻击的成功可能性</li></ul><h3 id="非执行内存-nx" tabindex="-1"><a class="header-anchor" href="#非执行内存-nx"><span>非执行内存(NX)</span></a></h3><p>Android强制执行NX位，防止数据页面被执行：</p><ul><li>标记堆、栈等为不可执行</li><li>防止代码注入攻击</li></ul><h3 id="控制流完整性-cfi" tabindex="-1"><a class="header-anchor" href="#控制流完整性-cfi"><span>控制流完整性(CFI)</span></a></h3><p>Android实现了CFI以防止控制流劫持：</p><ul><li>验证间接函数调用的合法性</li><li>防止返回导向编程(ROP)攻击</li></ul><h2 id="安全更新机制" tabindex="-1"><a class="header-anchor" href="#安全更新机制"><span>安全更新机制</span></a></h2><h3 id="安全补丁级别" tabindex="-1"><a class="header-anchor" href="#安全补丁级别"><span>安全补丁级别</span></a></h3><p>Android设备通过安全补丁级别(SPL)标识设备的安全状态：</p><ul><li>格式为&quot;YYYY-MM-DD&quot;</li><li>表示设备包含该日期之前的所有安全修复</li><li>通过<code>ro.build.version.security_patch</code>系统属性暴露</li></ul><h3 id="project-mainline" tabindex="-1"><a class="header-anchor" href="#project-mainline"><span>Project Mainline</span></a></h3><p>通过Google Play系统更新，Android可以直接更新关键系统组件：</p><ul><li>模块化的系统组件可通过Google Play更新</li><li>绕过OEM和运营商，直接修复安全漏洞</li><li>Framework中的<code>ModuleUpdateService</code>管理模块更新</li></ul><h2 id="实际应用与最佳实践" tabindex="-1"><a class="header-anchor" href="#实际应用与最佳实践"><span>实际应用与最佳实践</span></a></h2><h3 id="应用开发安全指南" tabindex="-1"><a class="header-anchor" href="#应用开发安全指南"><span>应用开发安全指南</span></a></h3><ol><li>最小权限原则：仅请求必需权限</li><li>安全存储敏感数据：使用KeyStore和加密API</li><li>安全通信：使用HTTPS和证书锁定</li><li>输入验证：验证所有外部输入</li><li>使用SafetyNet：检测设备完整性</li></ol><h3 id="系统开发安全指南" tabindex="-1"><a class="header-anchor" href="#系统开发安全指南"><span>系统开发安全指南</span></a></h3><ol><li>权限检查：每个敏感操作都需权限验证</li><li>SELinux策略：遵循最小权限原则</li><li>避免权限提升：谨慎使用<code>Binder.clearCallingIdentity()</code></li><li>安全IPC：验证所有IPC调用的来源</li><li>内存安全：使用内存安全语言或工具</li></ol><h2 id="结论" tabindex="-1"><a class="header-anchor" href="#结论"><span>结论</span></a></h2><p>Android的安全架构是一个多层次、深度防御的系统，从Linux内核到应用层都实施了严格的安全控制。了解这些安全机制不仅有助于开发更安全的应用，也有助于系统开发者实现更强大的安全特性。通过不断演进的安全模型，Android持续应对新的安全挑战，保护用户数据和隐私。</p><h2 id="参考资源" tabindex="-1"><a class="header-anchor" href="#参考资源"><span>参考资源</span></a></h2><ul><li><a href="https://source.android.com/security" target="_blank" rel="noopener noreferrer">Android安全与隐私文档</a></li><li><a href="https://developer.android.com/guide/topics/permissions/overview" target="_blank" rel="noopener noreferrer">Android权限系统概述</a></li><li><a href="https://source.android.com/security/selinux" target="_blank" rel="noopener noreferrer">SELinux for Android</a></li><li><a href="https://developer.android.com/training/articles/keystore" target="_blank" rel="noopener noreferrer">Android Keystore系统</a></li><li><a href="https://source.android.com/security/verifiedboot" target="_blank" rel="noopener noreferrer">验证启动</a></li></ul></div><!----><!----><!----></div></main><footer class="vp-doc-footer" data-v-94616537 data-v-76964c65><!--[--><!--]--><!----><div class="contributors" aria-label="Contributors" data-v-76964c65><span class="contributors-label" data-v-76964c65>贡献者: </span><span class="contributors-info" data-v-76964c65><!--[--><!--[--><span class="contributor" data-v-76964c65>Henry Thomas</span><!----><!--]--><!--]--></span></div><nav class="prev-next" data-v-76964c65><div class="pager" data-v-76964c65><a class="vp-link no-icon link pager-link prev" href="/henry.github.io/android/vo6noktt/" data-v-76964c65 data-v-87b5717a><!--[--><span class="desc" data-v-76964c65>上一页</span><span class="title" data-v-76964c65>定制ROM开发</span><!--]--><!----></a></div><div class="pager" data-v-76964c65><a class="vp-link no-icon link pager-link next" href="/henry.github.io/android/lc7oiob0/" data-v-76964c65 data-v-87b5717a><!--[--><span class="desc" data-v-76964c65>下一页</span><span class="title" data-v-76964c65>系统更新与OTA</span><!--]--><!----></a></div></nav></footer><!----><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button type="button" class="vp-back-to-top" aria-label="back to top" data-v-6b855051 style="display:none;" data-v-41e7b746><span class="percent" data-allow-mismatch data-v-41e7b746>0%</span><span class="show icon vpi-back-to-top" data-v-41e7b746></span><svg aria-hidden="true" data-v-41e7b746><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-41e7b746></circle></svg></button><footer class="vp-footer has-sidebar" vp-footer data-v-6b855051 data-v-5f4a75b0><!--[--><div class="container" data-v-5f4a75b0><p class="message" data-v-5f4a75b0>Powered by <a target="_blank" href="https://v2.vuepress.vuejs.org/">VuePress</a> & <a target="_blank" href="https://theme-plume.vuejs.press">vuepress-theme-plume</a></p><!----></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/henry.github.io/assets/app-BNwF3TyR.js" defer></script></body></html>
import{_ as l,c as d,b as i,a as n,d as e,e as t,r as p,o as h}from"./app-BNwF3TyR.js";const r={};function k(o,s){const a=p("Mermaid");return h(),d("div",null,[s[0]||(s[0]=i("blockquote",null,[i("p",null,[t("本章基于 "),i("a",{href:"https://ddia.vonng.com/ch3/",target:"_blank",rel:"noopener noreferrer"},"DDIA 中文翻译"),t(" 整理")])],-1)),s[1]||(s[1]=i("h2",{id:"章节概览",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#章节概览"},[i("span",null,"章节概览")])],-1)),n(a,{id:"mermaid-8",code:"eJyVk01PGlEUhvf+CoLbmvAhCi6aDDNM0sa0VZekC5NaNSXRKEnrDpUPRfygtQJiVBRlUiNIsRZmAH9M5947rPoXembuvXRIGpOyIPcM73POe965zK/MLi84JqeHHPARwk789Q7vVrFSQqc7enMPn10ZtQujdmsoMefbIUsVDDtRokEaGlXBY+upO+zU23mUfvzdPqZd9GbMSN3jWOVXbB21VVSusHabHZQucs4D7dKXlEO1llEvjdD2vbyG0zlUrvcSu1zsDTt7sQ1yqICYaF/waZwoDVQ9NieUj42SAqixfsitirDQUQqXLgesigNW4Zf2Pln/ge81s0s91ttUwDO66nC53eHL1y9eOfBhDWdgpToAdFWUzOmdAgfsLvF5FnUuqFeQG6lvKJNABzfUFzcqwYhid8ClZHcJy0E25rcVDXQh8Qez3c8a6sZprDRiTg/Eenutt85x8TtRH3uFEmrccpXdae8mj9RrXf0MAdKtYAApd3W1TDpZop1wsyFIdfBeWE/B78zUpDnu8g7n9yBVM56tA5I8Mw/nKZRKoswRl4NBcW15YW7FJGB3qyMp3huVDVNuvRaUaf19+SEwO/NGmLZmwGi9tQ2+QKs3t1Fik2hxLhwNO6XZ6Gxkad5UVuJoq0Dd9GKa0c2S9hFRzJgttQwR3OSJWqEjWQ/ZTF/d0bUHrNawegCN9OYu2q+h/Tx7nrtCjzkuN7eZmp6xnGkoWUBbSXJtXSi4lpUkLMiVsAX7k5WS5i2uZOH1GNUSqebMvU9UVFDoC+MOBcfIyHNHkP4D6NltLzz2wmtnRHof6ZkyrKAMKwYYid4MeqYMKyjDigEmRHOnZ8qwgjKs8NqLUXsDmWZDz7QBK2gDVrChq9G1yByQ7xcjkYlhMRTwSv5nq9GVpQ9zE8NjgjsYEFg58nHxXXRhwrP8yQYGGRhwiYIc6INu35hPdD0FigyU5ZDL7+mDsuyXXU+CEgMFnzQmjPdBT2hc8vI+/wRD/YlCMODug5J/1Ov2PQXK/xfOH0famuw="}),s[2]||(s[2]=i("h2",{id:"概述",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#概述"},[i("span",null,"概述")])],-1)),s[3]||(s[3]=i("p",null,"数据模型是软件开发中最重要的部分，因为它们不仅影响软件的编写方式，还影响我们思考问题的方式。",-1)),s[4]||(s[4]=i("h3",{id:"数据模型的抽象层次",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#数据模型的抽象层次"},[i("span",null,"数据模型的抽象层次")])],-1)),n(a,{id:"mermaid-18",code:"eJxLL0osyFDwCeJSAALHaKWnu6Y8n7Li6cYmm6Qifbun63e+2LjwcUPjs6kbnvWue7578rN5LUCuY4CnUixYi1O00suGWUAtEBXPVix8Oq8bpt0r2N9PQV8hwtcHYlrr5uebd79YuAIo9nT2PrDYs+nbnu7qh2iGGukMdMXaGU+bVjzdM/XZ5D6YYU66IUWpqWCmT7AvgvO0Y/rTPf0QHVATXKKVni9c82T3Nrg/2lqBCoDWBge7gAU8XFyAvOd7Jz7fPQeoCeJ7BV1dOwUnMOkMJl0gEsUllTmpQOm0zJwcK2VLA2dHN0ud4pKi/OxUK2VDUzNTZwMoV7c8M6Ukw8qooAJJoxNUo6Opi5mjOVyjkau5i7ERPo3OUI1ubq4GFjCVIK6FmwFeG13gGh2dLA3hGl0sTIwNTTE1AgD568ad"}),s[5]||(s[5]=e('<h2 id="关系模型-vs-文档模型" tabindex="-1"><a class="header-anchor" href="#关系模型-vs-文档模型"><span>关系模型 vs 文档模型</span></a></h2><h3 id="关系模型的特点" tabindex="-1"><a class="header-anchor" href="#关系模型的特点"><span>关系模型的特点</span></a></h3><table><thead><tr><th>特性</th><th>说明</th></tr></thead><tbody><tr><td>提出时间</td><td>1970 年（Edgar Codd）</td></tr><tr><td>核心概念</td><td>关系（表）包含元组（行）</td></tr><tr><td>主要应用</td><td>商业数据处理、事务处理、批处理</td></tr><tr><td>优势</td><td>数据一致性、强大的查询能力、成熟的生态</td></tr><tr><td>劣势</td><td>对象-关系阻抗失配</td></tr></tbody></table><h3 id="对象-关系阻抗失配" tabindex="-1"><a class="header-anchor" href="#对象-关系阻抗失配"><span>对象-关系阻抗失配</span></a></h3><p>面向对象编程与关系表之间存在不匹配：</p>',5)),n(a,{id:"mermaid-85",code:"eJxLL0osyFDwCeJSAALHaKWnu6Y8n7Liye7Fzxc0vt/T8XT9zhcbF77f06kUC1bhFK30csbuZ13Tny7Z+LK1FyrqHK30bOqGZ73rnu6aDNLUuvn55t0vFq6A6IMYraCra6fgBCadIULFJZU5qUCJtMycHCtlSwNnRzdLneKSovzsVCtlQ1MzU2cDKFe3PDOlJMPKqKACSaMTVKObm6OTpSFco4uFibGhKT6NzlCNjqYuZo7mcI1GruYuxkaYGgGzUGtb"}),s[6]||(s[6]=e(`<p><strong>ORM 框架的局限</strong>：</p><ul><li>无法完全隐藏模型差异</li><li>可能生成低效查询（N+1 问题）</li><li>对多样化数据系统支持有限</li></ul><h3 id="文档模型的优势" tabindex="-1"><a class="header-anchor" href="#文档模型的优势"><span>文档模型的优势</span></a></h3><p>以 LinkedIn 个人资料为例：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">user_id</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 123</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">name</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">张三</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">positions</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    {</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">company</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">A公司</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;"> &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">title</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">工程师</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;"> &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">years</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">2020-2022</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">},</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    {</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">company</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">B公司</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;"> &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">title</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">高级工程师</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;"> &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">years</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">2022-至今</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  ],</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">education</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    {</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">school</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">某大学</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;"> &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">degree</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">学士</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;"> &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">year</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2020</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  ]</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>优势</strong>：</p><ul><li>更好的局部性（树形结构数据）</li><li>减少阻抗失配</li><li>模式灵活性（schema-on-read）</li></ul><h3 id="规范化-vs-反规范化" tabindex="-1"><a class="header-anchor" href="#规范化-vs-反规范化"><span>规范化 vs 反规范化</span></a></h3><h4 id="规范化-normalization" tabindex="-1"><a class="header-anchor" href="#规范化-normalization"><span>规范化（Normalization）</span></a></h4>`,9)),n(a,{id:"mermaid-139",code:"eJxLL0osyFDwCeJSAALHaKXnU1Y869j+YuEKm6QifbvS4tSi+MwUMDsvMTcVzChKTc/MzwMKK8WCdTlFKz2ds+Fpzy6YLrgCZB5IO1ADxB4FXV27mqdLpr2csu7pnqlAO2sUnCBSztFKT/bMeNq1H6z30ZzJCk/bZj5tXfps9pan+1eDBRUUNJ72Tn3etBMo9mzaBk24ymdTNzzrXfdkR8OL9i3PGpbDxV90NT2f0/h07YynTSuer9z1cvoWqMtdgC7vWoywbLrCi/W7n/ZPezmn4cWyRgUvf08/uMyz+UtfrF/0dEnvs7lNT3cte7po3tOuBTAPFZdU5qQCvZWWmZNjpWxp4OzoZqlTXFKUn51qpWxoambqbADl6pZnppRkWBkVVCBpdCJXozNUo6Opi5mjOVyjkau5i7ERPo0uUI1ubo5OloZwjS4WJsaGppgaAWDn3sI="}),s[7]||(s[7]=i("h4",{id:"反规范化-denormalization",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#反规范化-denormalization"},[i("span",null,"反规范化（Denormalization）")])],-1)),n(a,{id:"mermaid-143",code:"eJxLL0osyFDwCeJSAALHaKXnU1Y869j+YuEKm6QifbvS4tSi+MwUMDsvMTcVzChKTc/Mz4sH8d/v6Xg+e8uzvqVP18542rTi/Z5OpVgusFFO0UpP9sx42rUfrOXRnMkKL9bvfto/7dnsLU/3rwYLKihoPJu+4OWcBgUvf08/TbjCZ/OXvli/6Pm6hqe9U4HGgUxzjlZ62rUYYdp0hWdTNzzrXfe0bfqTvTMRgkC3TNvwdEnvs7lNcMEnOxpetG951rD85eK+lzNXwhxYXFKZk6rgqJCWmZNjpezm5mpgYaRTXFKUn50K4lq4GRhAubrlmSklGVZGBRVIGp2gGh1NXcwczeEajVzNXYxh5mDV6Ay30dHJ0hCu0cXCxNjQFFMjAM15rW0="}),s[8]||(s[8]=e('<h3 id="模式灵活性对比" tabindex="-1"><a class="header-anchor" href="#模式灵活性对比"><span>模式灵活性对比</span></a></h3><table><thead><tr><th>特性</th><th>Schema-on-Write（关系型）</th><th>Schema-on-Read（文档型）</th></tr></thead><tbody><tr><td>模式定义</td><td>数据库强制执行</td><td>应用代码隐式处理</td></tr><tr><td>数据验证</td><td>写入时验证</td><td>读取时验证</td></tr><tr><td>灵活性</td><td>较低</td><td>较高</td></tr><tr><td>适用场景</td><td>结构稳定的数据</td><td>异构数据、频繁变化的结构</td></tr><tr><td>类比</td><td>静态类型语言</td><td>动态类型语言</td></tr></tbody></table><h2 id="图数据模型" tabindex="-1"><a class="header-anchor" href="#图数据模型"><span>图数据模型</span></a></h2><p>当多对多关系非常普遍时，图模型成为自然选择。</p><h3 id="图的基本组成" tabindex="-1"><a class="header-anchor" href="#图的基本组成"><span>图的基本组成</span></a></h3>',5)),n(a,{id:"mermaid-228",code:"eJxLL0osyFDwCeJSAALHaKWns/c9m7rhWe+6ZysWPp3XrRQLlnCKVnq5cNvzpp0KYalFJakVNklF+naPGhYpPJ2y/smOhmcL2l+sb3u+ZhlcHCjyfO0+jecbdwMN0UQo3zjvWcNyjZdT1j1t2PN0/U4kmdalL/bt1H/avgtIQW11jlYCchRcU9JTCVr4Yut2oPP0n+/uAFLoznjauvn55t0EHQO0FhIMCrq6dgpOSGxniHsUdPVe7J/3rG+pHlgeLFhcUpmTClSWlpmTY6Xs7Gpp7GKhU1xSlJ+daqVs5mjoZOkI5eqWZ6aUZFgZFVQgaXSCarQ0cHZ0s4RrNDQ1M3U2wKfRGarRzc3VwMIIrtHNzcLNAItGAN2kzm8="}),s[9]||(s[9]=i("p",null,[i("strong",null,"示例：社交网络图")],-1)),n(a,{id:"mermaid-232",code:"eJxLL0osyFDwCeJSAALHnMzk1GglMKUUCxZyyk+KVgISMG5qZlZmXjpQCMKACgdnJOalZyRmRivBWEAJhJEKurp2NW7+Pj7+4cE1ICPRpHw8w1yD4z39gHIQY2FWg2Wd/IP8wJIwsyEmF5dU5qRCDUnLzMmxUrY0cHZ0s9QpLinKz061UjY0NTN1NoBydcszU0oyrIwKKpA0g2wgVyvEoVDtjqYuZo7mcO1GruYuxkb4tMO8Qpp+ABx2ge4="}),s[10]||(s[10]=e(`<h3 id="属性图示例" tabindex="-1"><a class="header-anchor" href="#属性图示例"><span>属性图示例</span></a></h3><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>顶点：</span></span>
<span class="line"><span>(person:Person {name: &quot;张三&quot;, age: 30})</span></span>
<span class="line"><span>(location:Location {name: &quot;北京&quot;, type: &quot;city&quot;})</span></span>
<span class="line"><span></span></span>
<span class="line"><span>边：</span></span>
<span class="line"><span>(person) -[:LIVES_IN]-&gt; (location)</span></span>
<span class="line"><span>(person) -[:BORN_IN]-&gt; (location)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="图查询语言对比" tabindex="-1"><a class="header-anchor" href="#图查询语言对比"><span>图查询语言对比</span></a></h3><h4 id="cypher-neo4j" tabindex="-1"><a class="header-anchor" href="#cypher-neo4j"><span>Cypher（Neo4j）</span></a></h4><div class="language-cypher line-numbers-mode" data-ext="cypher" data-title="cypher"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>MATCH (person:Person) -[:BORN_IN]-&gt; () -[:WITHIN*0..]-&gt; (us:Location {name:&#39;United States&#39;})</span></span>
<span class="line"><span>RETURN person.name</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>特点</strong>：</p><ul><li>使用箭头符号表示关系</li><li>模式匹配语法直观</li><li>支持可变长度路径（<code>*0..</code>）</li></ul><h4 id="sql-递归查询" tabindex="-1"><a class="header-anchor" href="#sql-递归查询"><span>SQL 递归查询</span></a></h4><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WITH</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> RECURSIVE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> in_usa(vertex_id) </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> vertex_id </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> vertices </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> properties</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-&gt;&gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">name</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">United States</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  UNION</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  SELECT</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> edges</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">tail_vertex</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> edges</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    JOIN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> in_usa </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> edges</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">head_vertex</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> in_usa</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">vertex_id</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    WHERE</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> edges</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">label</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">within</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> vertices</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">properties</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">-&gt;&gt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">name</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> vertices</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">  JOIN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> in_usa </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> vertices</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">vertex_id</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> in_usa</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">vertex_id</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> vertices</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">label</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Person</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>特点</strong>：</p><ul><li>使用递归 CTE</li><li>语法复杂</li><li>需要显式处理递归逻辑</li></ul><h4 id="sparql-rdf-三元组存储" tabindex="-1"><a class="header-anchor" href="#sparql-rdf-三元组存储"><span>SPARQL（RDF/三元组存储）</span></a></h4><div class="language-sparql line-numbers-mode" data-ext="sparql" data-title="sparql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>PREFIX : &lt;urn:example:&gt;</span></span>
<span class="line"><span>SELECT ?personName WHERE {</span></span>
<span class="line"><span>  ?person :name ?personName.</span></span>
<span class="line"><span>  ?person :bornIn / :within* ?location.</span></span>
<span class="line"><span>  ?location :name &quot;United States&quot;.</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>特点</strong>：</p><ul><li>基于主语-谓语-宾语三元组</li><li>路径查询使用 <code>/</code> 和 <code>*</code></li><li>语义网标准</li></ul><h4 id="datalog" tabindex="-1"><a class="header-anchor" href="#datalog"><span>Datalog</span></a></h4><div class="language-datalog line-numbers-mode" data-ext="datalog" data-title="datalog"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>within_recursive(Location, Name) :- name(Location, Name).</span></span>
<span class="line"><span>within_recursive(Location, Name) :- within(Location, Via),</span></span>
<span class="line"><span>                                     within_recursive(Via, Name).</span></span>
<span class="line"><span></span></span>
<span class="line"><span>born_in_usa(Person, Name) :- born_in(Person, Location),</span></span>
<span class="line"><span>                              within_recursive(Location, &#39;United States&#39;),</span></span>
<span class="line"><span>                              name(Person, Name).</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>特点</strong>：</p><ul><li>基于规则的逻辑编程</li><li>通过规则组合构建复杂查询</li><li>增量式定义查询逻辑</li></ul><h2 id="事件溯源与-cqrs" tabindex="-1"><a class="header-anchor" href="#事件溯源与-cqrs"><span>事件溯源与 CQRS</span></a></h2><h3 id="事件溯源-event-sourcing" tabindex="-1"><a class="header-anchor" href="#事件溯源-event-sourcing"><span>事件溯源（Event Sourcing）</span></a></h3>`,21)),n(a,{id:"mermaid-342",code:"eJydj79OwlAUh3efoimrkBYstAwmt38uDE6ujYOJKEQSCZCoW2Wh1RBMJEAAo4sJi4CJQS0VXoZ7KxOvYGnLjUjCwB1+ycn5vnPPOcsf59LUweEO5Tyg0lPr2R494foXsqpzq4Vem6jURd8PyKjYt0Os3dBHLio6qHk3HQ2x2cfmPUGxoeGO4aGo2sTtdw9zNNeTiNd4QZPG3NKnnxVU7Tvs3DL84bJK27Uu1j+Q3kYjk0xY9JRlzxmN64NZqWf33lYIuEqgzgA9aitEQqVDoZBfJFV6prV+JuVZuYJrYw9E4wbSB//u9g6ggsF9SnZTcRO6mXAz6UGF4nU2RQHqNJPNxgMQAlFgdwvF/MV5Kh6Q+b0Iy/ll8DJzUkzHw7mrP6Loi4CToyBGxLASkyPhTaLkiwIjASgQkeWinMRsEmWyqsLwyy8WJQ+ZjaKyrQi3FRPbiklflBQhIvNEjAJWFMC6+AszaTnt"}),s[11]||(s[11]=e('<p><strong>优势</strong>：</p><ul><li>完整的审计日志</li><li>时间旅行调试</li><li>捕获用户意图</li><li>可重现的视图</li></ul><p><strong>挑战</strong>：</p><ul><li>外部数据处理</li><li>个人数据删除要求（GDPR）</li></ul><h3 id="cqrs-命令查询职责分离" tabindex="-1"><a class="header-anchor" href="#cqrs-命令查询职责分离"><span>CQRS（命令查询职责分离）</span></a></h3>',5)),n(a,{id:"mermaid-386",code:"eJxLL0osyFDwCeJSAALHaKWnbTOfti59smfG055pLxaueL5kl01Skb7dk13dT3ZvezZ96dP905ViwYqdopWebdn3fMr8p0tmPdmx6sX63U/7p0E1Lm97OnsfVJ1ztBKEr+D4fs+s51NWPOvY/rRjOtBwqAIXuAInoIIX6xY97Z36fPf8F+sWQhW4whU4AxU8mzDn+ZZFQPR0z1SgAojDFXR17RScIO4Cs52R2C5IbFeIhuKSypxUoLa0zJwcK2VLA2dHN0ud4pKi/OxUK2VDUzNTZwMoV7c8M6Ukw8qooAJJoxNUo7OrpbGLBVyjmaOhk6UjPo3OUI2Opi5mjuZwjUau5i7GRvg0upCr0ZU0jQDx58bv"}),s[12]||(s[12]=e(`<p><strong>核心思想</strong>：</p><ul><li>分离写入和读取的数据表示</li><li>每个视图针对特定查询模式优化</li><li>从事件日志派生物化视图</li></ul><p><strong>优势</strong>：</p><ul><li>灵活的查询优化</li><li>易于添加新视图</li><li>系统演化更容易</li></ul><h2 id="数据框与数组" tabindex="-1"><a class="header-anchor" href="#数据框与数组"><span>数据框与数组</span></a></h2><h3 id="数据框-dataframe" tabindex="-1"><a class="header-anchor" href="#数据框-dataframe"><span>数据框（Dataframe）</span></a></h3><p>数据框是关系数据库与科学计算的桥梁：</p><table><thead><tr><th>特性</th><th>关系表</th><th>数据框</th></tr></thead><tbody><tr><td>结构</td><td>行和列</td><td>行和列</td></tr><tr><td>列数</td><td>通常较少</td><td>可达数百列</td></tr><tr><td>操作</td><td>SQL 查询</td><td>矩阵运算、统计分析</td></tr><tr><td>应用</td><td>业务数据处理</td><td>数据科学、机器学习</td></tr></tbody></table><h3 id="常见转换操作" tabindex="-1"><a class="header-anchor" href="#常见转换操作"><span>常见转换操作</span></a></h3><h4 id="透视-pivot" tabindex="-1"><a class="header-anchor" href="#透视-pivot"><span>透视（Pivot）</span></a></h4><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>原始数据：</span></span>
<span class="line"><span>user_id | metric | value</span></span>
<span class="line"><span>1       | age    | 30</span></span>
<span class="line"><span>1       | income | 50000</span></span>
<span class="line"><span>2       | age    | 25</span></span>
<span class="line"><span></span></span>
<span class="line"><span>透视后：</span></span>
<span class="line"><span>user_id | age | income</span></span>
<span class="line"><span>1       | 30  | 50000</span></span>
<span class="line"><span>2       | 25  | NULL</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="独热编码-one-hot-encoding" tabindex="-1"><a class="header-anchor" href="#独热编码-one-hot-encoding"><span>独热编码（One-Hot Encoding）</span></a></h4><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>原始数据：</span></span>
<span class="line"><span>user_id | category</span></span>
<span class="line"><span>1       | A</span></span>
<span class="line"><span>2       | B</span></span>
<span class="line"><span>3       | A</span></span>
<span class="line"><span></span></span>
<span class="line"><span>编码后：</span></span>
<span class="line"><span>user_id | category_A | category_B</span></span>
<span class="line"><span>1       | 1          | 0</span></span>
<span class="line"><span>2       | 0          | 1</span></span>
<span class="line"><span>3       | 1          | 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="数据模型选择指南" tabindex="-1"><a class="header-anchor" href="#数据模型选择指南"><span>数据模型选择指南</span></a></h2><h3 id="决策树" tabindex="-1"><a class="header-anchor" href="#决策树"><span>决策树</span></a></h3>`,15)),n(a,{id:"mermaid-514",code:"eJyd0EtLAlEUB/B9n+Jiy5TKUlNCmJeP0EhdSgsrU0sc8UG5S0okzNLeGUhWhCSoIAmO5ZfJe9VVX6HreLOBQGhmcYa55/87nLm+iCfsBzbnFMAP5VagqzrKVnvtC1Q86h23YCepWBd7NO495OHH46j3eZDsp1/hSQrmKug6jUpPJMe4FfC5AGutYU01eo12v3MI63kMyNRyA1YLJM3+SaO76iCZxelB5RYKL13hvJ+8JGkO73DThMLZaEsc6gqZbruJ3oZbihETjpyW+9nc13thtBcql2Axs7wRmTXa+ZCPZ2klYPj4pp+lyVizxJAlfs0aH435Il6Xw6YE9gR+EWSRovuORKx6+cUdJVjxhOJR8/B6ibBKBNlbqCEhB2YA43C6fv6AAiqVEdBiNUlOGLGaJSesWC2SE06s1tGgaCwR9OLGdiAYNEwznH6BXVJGYxF+12uY1lLztJ4in6q9wFbMb1CH9yWQJlA/x1Am/RjOa7QaZm4SZORCVi7k5EITgZSG1VK6MVRzOnZBPQma5UKLXGj9H/wG2CR0uA=="}),s[13]||(s[13]=e('<h3 id="关键考虑因素" tabindex="-1"><a class="header-anchor" href="#关键考虑因素"><span>关键考虑因素</span></a></h3><table><thead><tr><th>因素</th><th>问题</th></tr></thead><tbody><tr><td>数据结构</td><td>是树形、表格还是图形？</td></tr><tr><td>关系复杂度</td><td>多对多关系有多普遍？</td></tr><tr><td>查询模式</td><td>主要是点查询、聚合还是图遍历？</td></tr><tr><td>写入模式</td><td>高写入还是高读取？</td></tr><tr><td>模式演化</td><td>结构变化频率如何？</td></tr><tr><td>数据一致性</td><td>需要强一致性还是最终一致性？</td></tr></tbody></table><h3 id="混合策略" tabindex="-1"><a class="header-anchor" href="#混合策略"><span>混合策略</span></a></h3><p>现代数据库越来越支持多模型：</p>',4)),n(a,{id:"mermaid-586",code:"eJxLL0osyFDwCeJSAALHaKWA/OKS9KLU4EAfpViwmFO00tPWzc83736xcIVNUpG+3ZM9C57vnq+AUOEcreQV7O/nBJZ9Nq392cLFz1YsfDqvGyrvEq30smHS072TFJxDXMGKns7e92z+0hfrF0FVuEYrPZu64fnulqeTep4u6X06oeP5xt0QAyDuUtDVtVNwQmI7I7FdkNiuEA3FJZU5qUChtMycHCtlSwNnRzdLneKSovzsVCtlQ1MzU2cDKFe3PDOlJMPKqKACSaMTVKOjqYuZozlco5GruYuxET6NzlCNbm6uBhYwlSCuhZsBXhtdoBqdXS2NXSzgGs0cDZ0sHfFpdIXb6OhkaQjX6GJhYmxoiqkRAFvYpDE="}),s[14]||(s[14]=i("blockquote",null,[i("p",null,"一个模型可以模拟另一个模型，但结果往往很笨拙。选择合适的数据模型对系统成功至关重要。")],-1)),s[15]||(s[15]=i("h2",{id:"核心原则",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#核心原则"},[i("span",null,"核心原则")])],-1)),s[16]||(s[16]=i("ul",null,[i("li",null,"根据数据结构和查询模式选择模型"),i("li",null,"规范化与反规范化需权衡读写性能"),i("li",null,"Schema-on-read 提供灵活性，Schema-on-write 提供保证"),i("li",null,"一个模型可以模拟另一个，但选择合适的模型至关重要"),i("li",null,"现代数据库支持多模型，可针对不同部分选择最优方案")],-1))])}const u=l(r,[["render",k]]),g=JSON.parse('{"path":"/ddia/vva8j2cd/","title":"第3章 数据模型与查询语言","lang":"zh-CN","frontmatter":{"title":"第3章 数据模型与查询语言","createTime":"2025/12/26 16:08:46","permalink":"/ddia/vva8j2cd/"},"headers":[],"readingTime":{"minutes":8.81,"words":2642},"git":{"updatedTime":1766740079000,"contributors":[{"name":"aidenreed937","username":"aidenreed937","email":"aidenreed937@gmail.com","commits":5,"avatar":"https://avatars.githubusercontent.com/aidenreed937?v=4","url":"https://github.com/aidenreed937"},{"name":"Claude Opus 4.5","username":"Claude Opus 4.5","email":"noreply@anthropic.com","commits":4,"avatar":"https://avatars.githubusercontent.com/Claude Opus 4.5?v=4","url":"https://github.com/Claude Opus 4.5"},{"name":"Claude Sonnet 4.5","username":"Claude Sonnet 4.5","email":"noreply@anthropic.com","commits":1,"avatar":"https://avatars.githubusercontent.com/Claude Sonnet 4.5?v=4","url":"https://github.com/Claude Sonnet 4.5"}]},"filePathRelative":"notes/ddia/part1-foundations/chapter-03.md","bulletin":false}');export{u as comp,g as data};
